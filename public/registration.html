<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–ª—è –±–∏–∑–Ω–µ—Å–∞ - Place&Play</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background: url('https://images.unsplash.com/photo-1526676037777-05a232554f77?auto=format&fit=crop&q=80') fixed;
            background-size: cover;
            background-position: center;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(247, 198, 199, 0.9), rgba(161, 196, 253, 0.9));
            backdrop-filter: blur(8px);
            z-index: -1;
        }

        .registration-container {
            background-color: #fff;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            width: 80%;
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
        }

        .registration-container h2 {
            margin-bottom: 20px;
            font-weight: 700;
            color: #113366;
        }

        .registration-container input, .registration-container textarea, .registration-container select {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .registration-container button {
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 700;
            font-size: 16px;
        }

        .registration-container button:hover {
            background-color: #0056b3;
        }

        .step {
            display: none;
            transition: opacity 0.3s ease-in-out;
            max-width: 100%;
        }

        .step.active {
            display: block;
            opacity: 1;
        }

        .alert {
            color: #d9534f;
            font-size: 0.9em;
            margin-bottom: 20px;
            background-color: #f8d7da;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #f5c6cb;
        }

        .progress {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .step-indicator {
            display: flex;
            gap: 5px;
            margin-left: 10px;
        }

        .step-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #ddd;
        }

        .step-dot.active {
            background-color: #007bff;
        }

        .working-hours {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .day {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 5px;
        }

        .day label {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .facilities {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .facility {
            flex: 1 1 30%;
            display: flex;
            align-items: center;
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            margin: 5px;
        }

        .facility input {
            margin-right: 10px;
        }

        .price-range {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 5px;
        }

        .price-range label {
            flex: 1;
            text-align: center;
        }

        .final-step {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        .final-step h3 {
            margin-bottom: 15px;
            color: #007bff;
            font-size: 1.2em;
        }

        .final-step button {
            background-color: #28a745;
            color: #fff;
            font-weight: bold;
            margin-top: 20px;
        }

        .final-step button:hover {
            background-color: #218838;
        }

        .attributes-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .org-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .attribute-item {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ */
        .small-attribute {
            grid-column: span 1;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤, –∑–∞–Ω–∏–º–∞—é—â–∏—Ö –≤—Å—é —à–∏—Ä–∏–Ω—É */
        .full-width-attribute {
            grid-column: 1 / -1;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ä–µ–¥–Ω–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ */
        .attribute-item:not(.small-attribute):not(.full-width-attribute) {
            grid-column: span 2;
        }

        .special-attributes {
            margin-top: 20px;
        }

        .attribute-item label {
            margin: 0 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
            color: #113366;
            font-size: 1.3em;
            position: relative;
            display: block;
            font-weight: 600;
        }

        .attribute-item label::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 50px;
            height: 2px;
            background: linear-gradient(to right, #4a90e2, #113366);
        }

        /* –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤ */
        .facilities-container {
            width: 100%;
            padding: 15px;
        }

        .facility-group {
            margin-bottom: 20px;
        }

        .facility-group-title {
            color: #113366;
            font-size: 1.1em;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 2px solid #e9ecef;
            position: relative;
        }

        .facility-group-title::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 40px;
            height: 2px;
            background: linear-gradient(to right, #4a90e2, #113366);
        }

        .facility-group-items {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .facility-item {
            background: white;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .facility-label {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.2s ease;
        }

        .facility-label:hover {
            background-color: #f8f9fa;
        }

        .facility-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .facility-icon {
            font-size: 1.2em;
            display: flex;
            align-items: center;
        }

        .facility-name {
            font-weight: 500;
            color: #495057;
        }

        .facility-item.active .facility-label {
            background: linear-gradient(45deg, #d4edda, #c3e6cb);
            color: #155724;
        }

        .facility-item.inactive .facility-label {
            background: linear-gradient(45deg, #f8d7da, #f5c6cb);
            color: #721c24;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —á–µ–∫–±–æ–∫—Å–∞ */
        .facility-checkbox {
            appearance: none;
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #ddd;
            border-radius: 4px;
            outline: none;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }

        .facility-checkbox:checked {
            background-color: #007bff;
            border-color: #007bff;
        }

        .facility-checkbox:checked::after {
            content: '‚úì';
            position: absolute;
            color: white;
            font-size: 14px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .facility-checkbox:hover {
            border-color: #007bff;
        }

        .dynamic-price-container {
            width: 100%;
        }

        .time-range-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: grid;
            grid-template-columns: 1fr 1fr 2fr auto;
            gap: 20px;
            align-items: center;
            margin-bottom: 15px;
            transition: transform 0.2s;
        }

        .time-range-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .time-range {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #f8f9fa;
            padding: 8px 15px;
            border-radius: 20px;
        }

        .time-separator {
            color: #666;
            font-weight: 500;
        }

        .price-value {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #d4edda;
            padding: 8px 15px;
            border-radius: 20px;
            color: #155724;
        }

        .currency {
            color: #155724;
            font-weight: 500;
        }

        .price-description {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .delete-range {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .delete-range:hover {
            background: #c82333;
        }

        .add-time-range {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: transform 0.2s;
        }

        .add-time-range:hover {
            transform: translateY(-2px);
        }

        .add-icon {
            font-size: 1.2em;
        }

        .working-hours-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .days-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .day-schedule {
            display: grid;
            grid-template-columns: 150px 1fr auto;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            gap: 20px;
        }

        .day-name {
            font-weight: 600;
            color: #113366;
        }

        .time-inputs {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .time-inputs input[type="time"] {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            width: 130px;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .button-group {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }

        .button-group button {
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .button-back {
            background-color: #6c757d !important;
        }

        .button-back:hover {
            background-color: #5a6268 !important;
        }

        @media (max-width: 768px) {
            .org-info-grid {
                grid-template-columns: 1fr;
            }

            .attribute-item,
            .small-attribute,
            .full-width-attribute {
                grid-column: 1 / -1;
            }

            .day-schedule {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .time-inputs {
                justify-content: space-between;
            }

            .facilities-grid {
                grid-template-columns: 1fr;
            }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ */
        .facility-item {
            position: relative;
            overflow: hidden;
        }

        .facility-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1), rgba(255,255,255,0.2));
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .facility-item:hover::before {
            transform: translateX(100%);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≥—Ä—É–ø–ø —É–¥–æ–±—Å—Ç–≤ */
        .facility-group {
            margin-bottom: 30px;
        }

        .facility-group-title {
            color: #113366;
            font-size: 1.1em;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e9ecef;
            position: relative;
        }

        .facility-group-title::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 40px;
            height: 2px;
            background: linear-gradient(to right, #4a90e2, #113366);
        }

        .facility-group-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .input-group {
            margin-bottom: 20px;
            position: relative;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .input-error {
            color: #dc3545;
            font-size: 0.85em;
            margin-top: 5px;
            min-height: 20px;
            transition: all 0.3s ease;
        }

        .input-group.error input {
            border-color: #dc3545;
        }

        .input-group.error input:focus {
            box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∏ */
        .input-group .input-error {
            opacity: 0;
            transform: translateY(-10px);
        }

        .input-group.error .input-error {
            opacity: 1;
            transform: translateY(0);
        }

        .coordinates-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .coordinates-hint {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .coordinates-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        h4 {
            color: #113366;
            margin: 0 0 10px 0;
        }

        #description {
            min-height: 100px;
            resize: vertical;
        }
    </style>
</head>
<body>
    <div class="registration-container">
        <div class="progress" id="progress">
            <span>–®–∞–≥ 1 –∏–∑ 3</span>
            <div class="step-indicator">
                <div class="step-dot active"></div>
                <div class="step-dot"></div>
                <div class="step-dot"></div>
            </div>
        </div>
        <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–ª—è –±–∏–∑–Ω–µ—Å–∞</h2>
        <p class="alert">–í—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ Place&Play –∫–∞–∫ –±–∏–∑–Ω–µ—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è. –≠—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–∞–∫ –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç–æ, —Ç–∞–∫ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ, –µ—Å–ª–∏ –≤—ã –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç–µ –±–∏–∑–Ω–µ—Å.</p>
        
        <div class="step active" id="step1">
            <div class="input-group">
                <input type="email" id="email" placeholder="Email" required>
                <div class="input-error"></div>
            </div>
            
            <div class="input-group">
                <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <div class="input-error"></div>
            </div>
            
            <div class="input-group">
                <input type="text" id="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ +998XXXXXXXXX" required>
                <div class="input-error"></div>
            </div>
            
            <div class="button-group">
                <button onclick="nextStep(2)">–î–∞–ª–µ–µ</button>
            </div>
        </div>

        <div class="step" id="step2">
            <select id="sportType" required onchange="loadAttributes()">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥ —Å–ø–æ—Ä—Ç–∞ –∏ —Ç–∏–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏</option>
            </select>
            
            <input type="text" id="orgType" placeholder="–¢–∏–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –¢–µ–Ω–Ω–∏—Å–Ω—ã–µ –∫–æ—Ä—Ç—ã)" required>
            
            <textarea id="address" placeholder="–ê–¥—Ä–µ—Å" required></textarea>
            
            <div class="input-group">
                <textarea id="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏" required></textarea>
                <div class="input-hint">–ü–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—à–∏—Ç–µ –≤–∞—à—É –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ —É—Å–ª—É–≥–∏ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</div>
            </div>
            
            <div class="coordinates-container">
                <h4>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–∞ –∫–∞—Ä—Ç–µ</h4>
                <div class="coordinates-hint">–£–∫–∞–∂–∏—Ç–µ —Ç–æ—á–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–∞—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ</div>
                
                <div class="coordinates-group">
                    <div class="input-group">
                        <input type="number" id="latitude" placeholder="–®–∏—Ä–æ—Ç–∞" step="any" required>
                        <div class="input-hint">–ù–∞–ø—Ä–∏–º–µ—Ä: 41.2995</div>
                    </div>
                    
                    <div class="input-group">
                        <input type="number" id="longitude" placeholder="–î–æ–ª–≥–æ—Ç–∞" step="any" required>
                        <div class="input-hint">–ù–∞–ø—Ä–∏–º–µ—Ä: 69.2401</div>
                    </div>
                </div>
            </div>
            
            <input type="text" id="orgName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏" required>
            
            <div class="button-group">
                <button class="button-back" onclick="prevStep(1)">–ù–∞–∑–∞–¥</button>
                <button onclick="nextStep(3)">–î–∞–ª–µ–µ</button>
            </div>
        </div>

        <div class="step" id="step3">
            <div id="attributes" class="attributes-container"></div>
            <div class="button-group">
                <button class="button-back" onclick="prevStep(2)">–ù–∞–∑–∞–¥</button>
                <button onclick="confirmRegistration()">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é</button>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', loadSports);

        async function loadSports() {
            try {
                console.log('–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –≤–∏–¥–æ–≤ —Å–ø–æ—Ä—Ç–∞...');
                const response = await fetch('/PlaceAndPlay/api/auth/getListOfSports', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'User-Agent': 'insomnia/10.3.1',
                        'language': 'ru'
                    },
                    credentials: 'include'
                });

                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${response.status}`);
                }

                const sports = await response.json();
                console.log('–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', sports);
                
                const sportTypeSelect = document.getElementById('sportType');
                sportTypeSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥ —Å–ø–æ—Ä—Ç–∞ –∏ —Ç–∏–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏</option>';

                sports.forEach(sport => {
                    const option = document.createElement('option');
                    option.value = sport.id;
                    option.textContent = sport.name;
                    sportTypeSelect.appendChild(option);
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö:', error);
                console.error('–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:', error.message);
            }
        }

        async function loadAttributes() {
            const sportTypeId = parseInt(document.getElementById('sportType').value);
            const attributesContainer = document.getElementById('attributes');
            attributesContainer.innerHTML = '<div class="loading"><div class="loading-spinner"></div></div>';

            if (!sportTypeId) return;

            try {
                const response = await fetch(`/PlaceAndPlay/api/auth/getAttrModelBySport?sportId=${sportTypeId}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'User-Agent': 'insomnia/10.3.1',
                        'language': 'ru'
                    },
                    credentials: 'include'
                });

                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${response.status}`);
                }

                const data = await response.json();
                console.log('–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã:', data);

                if (!data || !data.orgInfo || !data.orgInfo.attributes) {
                    throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤');
                }

                const attributes = data.orgInfo.attributes;
                attributesContainer.innerHTML = '';

                // –°–æ–∑–¥–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Å–µ—Ç–∫—É –¥–ª—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤
                const mainGrid = document.createElement('div');
                mainGrid.className = 'org-info-grid';

                // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (—á–∞—Å—ã —Ä–∞–±–æ—Ç—ã –∏ —Ü–µ–Ω—ã)
                const specialContainer = document.createElement('div');
                specialContainer.className = 'special-attributes';

                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∞—Ç—Ä–∏–±—É—Ç—ã –ø–æ —Ç–∏–ø–∞–º
                Object.entries(attributes).forEach(([key, attribute]) => {
                    if (key === 'openHours' || key === 'pricePerHour') {
                        const itemDiv = createAttributeInput(key, attribute);
                        specialContainer.appendChild(itemDiv);
                    } else {
                        const itemDiv = createAttributeInput(key, attribute);
                        mainGrid.appendChild(itemDiv);
                    }
                });

                // –î–æ–±–∞–≤–ª—è–µ–º —Å–Ω–∞—á–∞–ª–∞ –æ—Å–Ω–æ–≤–Ω—É—é —Å–µ—Ç–∫—É, –∑–∞—Ç–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã
                attributesContainer.appendChild(mainGrid);
                attributesContainer.appendChild(specialContainer);

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                window.selectedSportId = sportTypeId;
                window.selectedSportData = data;

            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤:', error);
                attributesContainer.innerHTML = `
                    <div class="error-message">
                        –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.<br>
                        <small>${error.message}</small>
                    </div>
                `;
            }
        }

        function createAttributeInput(key, attribute) {
            const itemDiv = document.createElement('div');
            itemDiv.className = 'attribute-item';
            itemDiv.setAttribute('data-attribute', key);
            itemDiv.setAttribute('data-input-type', attribute.input);

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
            if (attribute.input === 'boolean' || attribute.input === 'int' || 
                (attribute.input === 'select' && (!attribute.options || attribute.options.length <= 3))) {
                itemDiv.classList.add('small-attribute');
            } else if (attribute.input === 'boolean_group' || attribute.input === 'multiselect' ||
                       attribute.input === 'json' || attribute.input === 'dynamic_time_price') {
                itemDiv.classList.add('full-width-attribute');
            }

            const label = document.createElement('label');
            label.textContent = attribute.name.ru;
            itemDiv.appendChild(label);

            switch (attribute.input) {
                case 'boolean':
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.id = key;
                    checkbox.checked = attribute.value || false;
                    itemDiv.appendChild(checkbox);
                    break;

                case 'int':
                    const intInput = document.createElement('input');
                    intInput.type = 'number';
                    intInput.id = key;
                    intInput.value = attribute.value || 0;
                    intInput.step = '1';
                    itemDiv.appendChild(intInput);
                    break;

                case 'multiselect':
                    const selectContainer = document.createElement('div');
                    selectContainer.className = 'multiselect-container';
                    
                    attribute.options.forEach(option => {
                        const optionDiv = document.createElement('div');
                        optionDiv.className = 'multiselect-option';
                        
                        const checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.id = `${key}_${option.id}`;
                        checkbox.value = option.id;
                        checkbox.checked = attribute.value?.includes(option.id);
                        
                        const optionLabel = document.createElement('label');
                        optionLabel.htmlFor = `${key}_${option.id}`;
                        optionLabel.textContent = option.name.ru;
                        
                        optionDiv.appendChild(checkbox);
                        optionDiv.appendChild(optionLabel);
                        selectContainer.appendChild(optionDiv);
                    });
                    itemDiv.appendChild(selectContainer);
                    break;

                case 'select':
                    const select = document.createElement('select');
                    select.id = key;
                    attribute.options.forEach(option => {
                        const optionElement = document.createElement('option');
                        optionElement.value = option;
                        optionElement.textContent = option;
                        optionElement.selected = option === attribute.value;
                        select.appendChild(optionElement);
                    });
                    itemDiv.appendChild(select);
                    break;

                case 'boolean_group':
                    const facilitiesContainer = document.createElement('div');
                    facilitiesContainer.className = 'facilities-container';
                    
                    // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É–¥–æ–±—Å—Ç–≤–∞
                    const facilityGroups = {
                        main: {
                            title: '–û—Å–Ω–æ–≤–Ω—ã–µ —É–¥–æ–±—Å—Ç–≤–∞',
                            items: ['changingRooms', 'showerAvailable', 'parkingAvailability']
                        },
                        sport: {
                            title: '–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å',
                            items: ['racketRental', 'ballAvailability', 'stringingService', 'equipmentAvailable','cueRental']
                        },
                        additional: {
                            title: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏',
                            items: ['wifiAvailable', 'cafeAvailable', 'coachAvailable', 'lightingAvailable']
                        }
                    };

                    const facilityIcons = {
                        racketRental: 'üéæ',
                        ballAvailability: '‚öæ',
                        changingRooms: 'üö™',
                        showerAvailable: 'üöø',
                        parkingAvailability: 'üÖøÔ∏è',
                        wifiAvailable: 'üì∂',
                        cafeAvailable: '‚òï',
                        coachAvailable: 'üë®‚Äçüè´',
                        lightingAvailable: 'üí°',
                        equipmentAvailable: 'üéΩ',
                        stringingService: 'üîß',
                        cueRental: 'üé≠'
                    };

                    const facilityNames = {
                        racketRental: '–ê—Ä–µ–Ω–¥–∞ —Ä–∞–∫–µ—Ç–æ–∫',
                        ballAvailability: '–ú—è—á–∏',
                        changingRooms: '–†–∞–∑–¥–µ–≤–∞–ª–∫–∏',
                        showerAvailable: '–î—É—à–µ–≤—ã–µ',
                        parkingAvailability: '–ü–∞—Ä–∫–æ–≤–∫–∞',
                        wifiAvailable: 'Wi-Fi',
                        cafeAvailable: '–ö–∞—Ñ–µ',
                        coachAvailable: '–¢—Ä–µ–Ω–µ—Ä',
                        lightingAvailable: '–û—Å–≤–µ—â–µ–Ω–∏–µ',
                        equipmentAvailable: '–≠–∫–∏–ø–∏—Ä–æ–≤–∫–∞',
                        stringingService: '–ù–∞—Ç—è–∂–∫–∞ —Ä–∞–∫–µ—Ç–æ–∫',
                        cueRental: '–ê—Ä–µ–Ω–¥–∞ –∫–∏—è'
                    };

                    Object.entries(facilityGroups).forEach(([groupKey, group]) => {
                        const groupContainer = document.createElement('div');
                        groupContainer.className = 'facility-group';
                        
                        const groupTitle = document.createElement('h4');
                        groupTitle.className = 'facility-group-title';
                        groupTitle.textContent = group.title;
                        groupContainer.appendChild(groupTitle);

                        const groupItems = document.createElement('div');
                        groupItems.className = 'facility-group-items';

                        group.items.forEach(facilityKey => {
                            if (attribute.value.hasOwnProperty(facilityKey)) {
                                const facilityDiv = document.createElement('div');
                                facilityDiv.className = 'facility-item';
                                
                                const facilityLabel = document.createElement('label');
                                facilityLabel.className = 'facility-label';
                                
                                const facilityCheckbox = document.createElement('input');
                                facilityCheckbox.type = 'checkbox';
                                facilityCheckbox.name = facilityKey;
                                facilityCheckbox.id = `facility-${facilityKey}`;
                                facilityCheckbox.checked = attribute.value[facilityKey];
                                facilityCheckbox.className = 'facility-checkbox';
                                
                                const facilityIcon = document.createElement('span');
                                facilityIcon.className = 'facility-icon';
                                facilityIcon.textContent = facilityIcons[facilityKey];

                                const facilityText = document.createElement('span');
                                facilityText.className = 'facility-name';
                                facilityText.textContent = facilityNames[facilityKey];
                                
                                facilityLabel.appendChild(facilityCheckbox);
                                facilityLabel.appendChild(facilityIcon);
                                facilityLabel.appendChild(facilityText);
                                facilityDiv.appendChild(facilityLabel);

                                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
                                facilityCheckbox.addEventListener('change', function() {
                                    facilityDiv.classList.toggle('active', this.checked);
                                    facilityDiv.classList.toggle('inactive', !this.checked);
                                });

                                facilityDiv.classList.add(attribute.value[facilityKey] ? 'active' : 'inactive');
                                groupItems.appendChild(facilityDiv);
                            }
                        });

                        groupContainer.appendChild(groupItems);
                        facilitiesContainer.appendChild(groupContainer);
                    });
                    
                    itemDiv.appendChild(facilitiesContainer);
                    break;

                case 'dynamic_time_price':
                    const priceContainer = document.createElement('div');
                    priceContainer.className = 'dynamic-price-container';

                    const timeRanges = document.createElement('div');
                    timeRanges.className = 'time-ranges';
                    timeRanges.id = `${key}_ranges`;

                    // –î–æ–±–∞–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
                    if (attribute.value && Array.isArray(attribute.value)) {
                        attribute.value.forEach(range => {
                            const rangeItem = document.createElement('div');
                            rangeItem.className = 'time-range-item';
                            rangeItem.innerHTML = `
                                <div class="time-range">
                                    <span class="time-icon">üïí</span>
                                    <input type="time" class="time-start" value="${range.timeRange.start}" required>
                                    <span class="time-separator">‚Äî</span>
                                    <input type="time" class="time-end" value="${range.timeRange.end}" required>
                                </div>
                                <div class="price-value">
                                    <span class="price-icon">üí∞</span>
                                    <input type="number" class="price" value="${range.price}" required>
                                    <span class="currency">—Å—É–º</span>
                                </div>
                                <div class="price-description">
                                    <span class="desc-icon">üìù</span>
                                    <input type="text" class="description" value="${range.description.ru}" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞" required>
                                </div>
                                <button type="button" class="delete-range" onclick="deleteTimeRange(this)">‚úï</button>
                            `;
                            timeRanges.appendChild(rangeItem);
                        });
                    }

                    const addButton = document.createElement('button');
                    addButton.type = 'button';
                    addButton.className = 'add-time-range';
                    addButton.innerHTML = '<span class="add-icon">+</span> –î–æ–±–∞–≤–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª';
                    addButton.onclick = () => addTimeRange(key);

                    priceContainer.appendChild(timeRanges);
                    priceContainer.appendChild(addButton);
                    itemDiv.appendChild(priceContainer);
                    break;

                case 'json':
                    if (key === 'openHours') {
                        const scheduleContainer = createWorkingHoursSection(attribute);
                        itemDiv.appendChild(scheduleContainer);
                    }
                    break;

                default:
                    const defaultInput = document.createElement('input');
                    defaultInput.type = 'text';
                    defaultInput.id = key;
                    defaultInput.value = attribute.value || '';
                    itemDiv.appendChild(defaultInput);
            }

            return itemDiv;
        }

        function addTimeRange(key) {
            const timeRanges = document.getElementById(`${key}_ranges`);
            const rangeItem = document.createElement('div');
            rangeItem.className = 'time-range-item';

            rangeItem.innerHTML = `
                <input type="time" class="time-start" value="09:00" required>
                <input type="time" class="time-end" value="22:00" required>
                <div class="price-description">
                    <input type="number" class="price" placeholder="–¶–µ–Ω–∞" required>
                    <input type="text" class="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞" required>
                </div>
                <button type="button" class="delete-range" onclick="deleteTimeRange(this)">‚úï</button>
            `;

            timeRanges.appendChild(rangeItem);
        }

        function deleteTimeRange(button) {
            const timeRanges = document.getElementById(`${button.parentElement.dataset.attribute}_ranges`);
            if (timeRanges.children.length > 1) {
                button.parentElement.remove();
            } else {
                alert('–î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª');
            }
        }

        function updateStepIndicators(step) {
            const dots = document.querySelectorAll('.step-dot');
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index + 1 <= step);
            });
        }

        function nextStep(step) {
            if (validateStep(getCurrentStep())) {
                document.querySelectorAll('.step').forEach((el) => el.classList.remove('active'));
                document.getElementById('step' + step).classList.add('active');
                document.getElementById('progress').querySelector('span').textContent = `–®–∞–≥ ${step} –∏–∑ 3`;
                updateStepIndicators(step);
            }
        }

        function prevStep(step) {
            document.querySelectorAll('.step').forEach((el) => el.classList.remove('active'));
            document.getElementById('step' + step).classList.add('active');
            document.getElementById('progress').querySelector('span').textContent = `–®–∞–≥ ${step} –∏–∑ 3`;
            updateStepIndicators(step);
        }

        function getCurrentStep() {
            const activeStep = document.querySelector('.step.active');
            return parseInt(activeStep.id.replace('step', ''));
        }

        function validateStep(step) {
            // –°–Ω–∞—á–∞–ª–∞ –æ—á–∏—â–∞–µ–º –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ—à–∏–±–∫–∏
            clearErrors();

            switch(step) {
                case 1:
                    let isValid = true;
                    const email = document.getElementById('email').value;
                    const password = document.getElementById('password').value;
                    const phone = document.getElementById('phone').value;

                    // –í–∞–ª–∏–¥–∞—Ü–∏—è email
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailRegex.test(email)) {
                        showError('email', '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email –∞–¥—Ä–µ—Å');
                        isValid = false;
                    }

                    // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è
                    const passwordRegex = /^(?=.*[A-Z])(?=.*\d).{6,}$/;
                    if (!passwordRegex.test(password)) {
                        showError('password', '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤, –≤–∫–ª—é—á–∞—è –∑–∞–≥–ª–∞–≤–Ω—É—é –±—É–∫–≤—É –∏ —Ü–∏—Ñ—Ä—É');
                        isValid = false;
                    }

                    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
                    const phoneRegex = /^\+998[0-9]{9}$/;
                    if (!phoneRegex.test(phone)) {
                        showError('phone', '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ +998XXXXXXXXX');
                        isValid = false;
                    }

                    return isValid;
                case 2:
                    const sportType = document.getElementById('sportType').value;
                    const orgType = document.getElementById('orgType').value;
                    const address = document.getElementById('address').value;
                    const description = document.getElementById('description').value;
                    const latitude = document.getElementById('latitude').value;
                    const longitude = document.getElementById('longitude').value;
                    const orgName = document.getElementById('orgName').value;

                    if (!sportType || !orgType || !address || !description || !latitude || !longitude || !orgName) {
                        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                        return false;
                    }

                    // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
                    if (isNaN(latitude) || latitude < -90 || latitude > 90) {
                        showError('latitude', '–®–∏—Ä–æ—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç -90 –¥–æ 90');
                        return false;
                    }

                    if (isNaN(longitude) || longitude < -180 || longitude > 180) {
                        showError('longitude', '–î–æ–ª–≥–æ—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç -180 –¥–æ 180');
                        return false;
                    }

                    // –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏—è
                    if (description.trim().length < 10) {
                        showError('description', '–û–ø–∏—Å–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –º–µ–Ω–µ–µ 10 —Å–∏–º–≤–æ–ª–æ–≤');
                        return false;
                    }

                    return true;
                case 3:
                    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –∞—Ç—Ä–∏–±—É—Ç–æ–≤
                    return true;
                default:
                    return true;
            }
        }

        function confirmRegistration() {
            if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –±–∏–∑–Ω–µ—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ Place&Play?")) {
                register();
            }
        }

        function collectFormData() {
            const formData = {
                email: document.getElementById('email').value,
                password: document.getElementById('password').value,
                phone: document.getElementById('phone').value,
                orgName: document.getElementById('orgName').value,
                address: document.getElementById('address').value,
                sportTypeId: parseInt(window.selectedSportId),
                currentLocation: 1,
                sportIds: [parseInt(window.selectedSportId)],
                orgType: document.getElementById('sportType').options[document.getElementById('sportType').selectedIndex].text,
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—è description, latitude –∏ longitude –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ
                description: document.getElementById('description').value,
                latitude: parseFloat(document.getElementById('latitude').value),
                longitude: parseFloat(document.getElementById('longitude').value),
                
                orgInfo: {
                    name: {
                        en: document.getElementById('orgName').value,
                        ru: document.getElementById('orgName').value,
                        uz: document.getElementById('orgName').value
                    },
                    sportName: {
                        en: document.getElementById('sportType').options[document.getElementById('sportType').selectedIndex].text,
                        ru: document.getElementById('sportType').options[document.getElementById('sportType').selectedIndex].text,
                        uz: document.getElementById('sportType').options[document.getElementById('sportType').selectedIndex].text
                    },
                    attributes: {}
                }
            };

            // –°–æ–±–∏—Ä–∞–µ–º –∞—Ç—Ä–∏–±—É—Ç—ã
            const savedAttributes = window.selectedSportData.orgInfo.attributes;
            for (const [key, attr] of Object.entries(savedAttributes)) {
                const attributeValue = getAttributeValue(key, attr.input);
                formData.orgInfo.attributes[key] = {
                    name: attr.name,
                    input: attr.input,
                    value: attributeValue
                };
                if (attr.options) {
                    formData.orgInfo.attributes[key].options = attr.options;
                }
            }

            console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:', formData); // –î–æ–±–∞–≤–ª—è–µ–º –ª–æ–≥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            return formData;
        }

        function getAttributeValue(key, inputType) {
            const element = document.querySelector(`[data-attribute="${key}"]`);
            if (!element) return null;

            switch (inputType) {
                case 'boolean':
                    return element.querySelector('input[type="checkbox"]').checked;

                case 'int':
                    return parseInt(element.querySelector('input[type="number"]').value) || 0;

                case 'decimal':
                    return parseFloat(element.querySelector('input[type="number"]').value) || 0;

                case 'select':
                    return element.querySelector('select').value;

                case 'multiselect':
                    const selectedCheckboxes = element.querySelectorAll('input[type="checkbox"]:checked');
                    return Array.from(selectedCheckboxes).map(cb => parseInt(cb.value));

                case 'boolean_group':
                    const checkboxes = element.querySelectorAll('input[type="checkbox"]');
                    const values = {};
                    checkboxes.forEach(cb => {
                        values[cb.name] = cb.checked;
                    });
                    return values;

                case 'dynamic_time_price':
                    const ranges = element.querySelectorAll('.time-range-item');
                    const timeRanges = [];

                    ranges.forEach(range => {
                        timeRanges.push({
                            timeRange: {
                                start: range.querySelector('.time-start').value,
                                end: range.querySelector('.time-end').value
                            },
                            price: parseInt(range.querySelector('.price').value),
                            description: {
                                en: range.querySelector('.description').value,
                                ru: range.querySelector('.description').value,
                                uz: range.querySelector('.description').value
                            }
                        });
                    });
                    return timeRanges;

                case 'json':
                    if (key === 'openHours') {
                        const section = element.querySelector('.working-hours-section');
                        return {
                            active: section.querySelector('#working-hours-active').checked,
                            schedule: {
                                monday: {
                                    isWorking: section.querySelector('#monday-working').checked,
                                    start: section.querySelector('#monday-start').value,
                                    end: section.querySelector('#monday-end').value
                                },
                                tuesday: {
                                    isWorking: section.querySelector('#tuesday-working').checked,
                                    start: section.querySelector('#tuesday-start').value,
                                    end: section.querySelector('#tuesday-end').value
                                },
                                wednesday: {
                                    isWorking: section.querySelector('#wednesday-working').checked,
                                    start: section.querySelector('#wednesday-start').value,
                                    end: section.querySelector('#wednesday-end').value
                                },
                                thursday: {
                                    isWorking: section.querySelector('#thursday-working').checked,
                                    start: section.querySelector('#thursday-start').value,
                                    end: section.querySelector('#thursday-end').value
                                },
                                friday: {
                                    isWorking: section.querySelector('#friday-working').checked,
                                    start: section.querySelector('#friday-start').value,
                                    end: section.querySelector('#friday-end').value
                                },
                                saturday: {
                                    isWorking: section.querySelector('#saturday-working').checked,
                                    start: section.querySelector('#saturday-start').value,
                                    end: section.querySelector('#saturday-end').value
                                },
                                sunday: {
                                    isWorking: section.querySelector('#sunday-working').checked,
                                    start: section.querySelector('#sunday-start').value,
                                    end: section.querySelector('#sunday-end').value
                                }
                            }
                        };
                    }
                    return null;

                default:
                    return element.querySelector('input').value;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        function register() {
            const formData = collectFormData();
            
            console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:', formData);

            fetch('/PlaceAndPlay/api/organizations/registration', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'User-Agent': 'insomnia/10.3.1',
                    'language': 'ru'
                },
                credentials: 'include',
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                console.log('–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', data);
                alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞
                window.location.href = '/login.html';
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
                alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
            });
        }

        function createWorkingHoursSection(attribute) {
            const workingHoursSection = document.createElement('div');
            workingHoursSection.className = 'working-hours-section';

            const header = document.createElement('div');
            header.className = 'section-header';
            
            const toggleContainer = document.createElement('div');
            toggleContainer.className = 'working-hours-toggle';
            toggleContainer.style.marginBottom = '20px';
            
            const toggleLabel = document.createElement('span');
            toggleLabel.textContent = '–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –∞–∫—Ç–∏–≤–µ–Ω';
            toggleLabel.style.marginRight = '10px';

            const toggleInput = document.createElement('input');
            toggleInput.type = 'checkbox';
            toggleInput.id = 'working-hours-active';
            toggleInput.checked = attribute.value?.active ?? true;

            toggleContainer.appendChild(toggleLabel);
            toggleContainer.appendChild(toggleInput);
            header.appendChild(toggleContainer);
            workingHoursSection.appendChild(header);

            const daysContainer = document.createElement('div');
            daysContainer.className = 'days-container';

            const days = {
                monday: '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫',
                tuesday: '–í—Ç–æ—Ä–Ω–∏–∫',
                wednesday: '–°—Ä–µ–¥–∞',
                thursday: '–ß–µ—Ç–≤–µ—Ä–≥',
                friday: '–ü—è—Ç–Ω–∏—Ü–∞',
                saturday: '–°—É–±–±–æ—Ç–∞',
                sunday: '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'
            };

            Object.entries(days).forEach(([dayKey, dayName]) => {
                const daySchedule = attribute.value?.schedule?.[dayKey] || { 
                    isWorking: true, 
                    start: '09:00', 
                    end: '22:00' 
                };

                const dayRow = document.createElement('div');
                dayRow.className = 'day-schedule';

                const dayLabel = document.createElement('div');
                dayLabel.className = 'day-name';
                dayLabel.textContent = dayName;

                const timeContainer = document.createElement('div');
                timeContainer.className = 'time-inputs';

                const startTime = document.createElement('input');
                startTime.type = 'time';
                startTime.id = `${dayKey}-start`;
                startTime.value = daySchedule.start;

                const separator = document.createElement('span');
                separator.textContent = '‚Äî';
                separator.style.color = '#666';

                const endTime = document.createElement('input');
                endTime.type = 'time';
                endTime.id = `${dayKey}-end`;
                endTime.value = daySchedule.end;

                const workingToggle = document.createElement('div');
                workingToggle.className = 'working-day-toggle';

                const workingCheckbox = document.createElement('input');
                workingCheckbox.type = 'checkbox';
                workingCheckbox.id = `${dayKey}-working`;
                workingCheckbox.checked = daySchedule.isWorking;

                const workingLabel = document.createElement('label');
                workingLabel.htmlFor = `${dayKey}-working`;
                workingLabel.textContent = '–†–∞–±–æ—á–∏–π –¥–µ–Ω—å';

                workingCheckbox.addEventListener('change', function() {
                    startTime.disabled = !this.checked;
                    endTime.disabled = !this.checked;
                    dayRow.classList.toggle('disabled', !this.checked);
                });

                timeContainer.appendChild(startTime);
                timeContainer.appendChild(separator);
                timeContainer.appendChild(endTime);

                workingToggle.appendChild(workingCheckbox);
                workingToggle.appendChild(workingLabel);

                dayRow.appendChild(dayLabel);
                dayRow.appendChild(timeContainer);
                dayRow.appendChild(workingToggle);

                if (!daySchedule.isWorking) {
                    startTime.disabled = true;
                    endTime.disabled = true;
                    dayRow.classList.add('disabled');
                }

                daysContainer.appendChild(dayRow);
            });

            workingHoursSection.appendChild(daysContainer);
            return workingHoursSection;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –æ—à–∏–±–æ–∫
        function clearErrors() {
            const errorElements = document.querySelectorAll('.input-error');
            const inputGroups = document.querySelectorAll('.input-group');
            
            errorElements.forEach(error => error.textContent = '');
            inputGroups.forEach(group => group.classList.remove('error'));
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–∫–∞–∑–∞ –æ—à–∏–±–æ–∫
        function showError(fieldId, message) {
            const field = document.getElementById(fieldId);
            const group = field.closest('.input-group');
            const errorDiv = group.querySelector('.input-error');
            
            group.classList.add('error');
            errorDiv.textContent = message;
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        document.addEventListener('DOMContentLoaded', function() {
            const email = document.getElementById('email');
            const password = document.getElementById('password');
            const phone = document.getElementById('phone');

            // –û—á–∏—â–∞–µ–º –æ—à–∏–±–∫—É –ø—Ä–∏ –Ω–∞—á–∞–ª–µ –≤–≤–æ–¥–∞
            email.addEventListener('input', function() {
                const group = this.closest('.input-group');
                group.classList.remove('error');
                group.querySelector('.input-error').textContent = '';
            });

            password.addEventListener('input', function() {
                const group = this.closest('.input-group');
                group.classList.remove('error');
                group.querySelector('.input-error').textContent = '';
            });

            phone.addEventListener('input', function() {
                const group = this.closest('.input-group');
                group.classList.remove('error');
                group.querySelector('.input-error').textContent = '';
            });
        });
    </script>
</body>
</html> 